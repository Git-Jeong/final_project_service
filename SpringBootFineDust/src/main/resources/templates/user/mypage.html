<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>개인정보 수정</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet" />
<link rel="stylesheet" href="/css/user/mypage.css" />
</head>

<body>
	<div class="mypage-container">
		<div class="mypage-header">
			<img src="https://cdn-icons-png.flaticon.com/512/847/847969.png"
				alt="profile icon" />
			<div class="mypage-title">개인정보 수정</div>
		</div>

		<form id="user-form" class="mypage-form">
			<div class="mypage-l-form">
				<div>
					<label for="usrEmail">이메일</label> <input type="email" id="usrEmail"
						name="usrEmail" placeholder="figma@gmail.com" required />
				</div>

				<div>
				  <label>비밀번호 <span style="color: red;">*</span>
				    <span style="color: black;">(문자, 숫자, 특수문자 포함 8~20자)</span>
				  </label>
				  <div class="mypage-password-group">
				    <input
				      type="password"
				      id="usrPw"
				      name="usrPw"
				      placeholder="비밀번호를 입력해 주세요."
				      required
				      maxlength="20"
				      pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,20}$"
				    />
				    <input
				      type="password"
				      id="usrPwCheck"
				      name="usrPwCheck"
				      placeholder="비밀번호를 재입력해 주세요."
				      required
				    />
				  </div>
				</div>

				<div>
					<label for="usrNick">닉네임</label> <input type="text" id="usrNick"
						name="usrNick" placeholder="닉네임을 입력해 주세요." required />
				</div>
			</div>
			<div class="mypage-right-form">
				<div>
					<label for="stName_1">지하철역</label> <input type="text" id="stName_2"
						name="stName_1" placeholder="지하철역을 입력해 주세요." />
				</div>
				<div>
					<label for="stName_2" style="visibility: hidden;">지하철역</label> <input type="text" id="stName_2"
						name="stName_2" placeholder="지하철역을 입력해 주세요." />
				</div>
				<div>
					<label for="stName_3" style="visibility: hidden;">지하철역</label> <input type="text" id="stName_3"
						name="stName_3" placeholder="지하철역을 입력해 주세요." />
				</div>
			</div>


			<div class="mypage-buttons">
				<button type="submit" class="mypage-btn submit">수정</button>
				<button type="reset" class="mypage-btn cancel">취소</button>
				
			</div>
		</form>
	</div>

	<script>
    document.getElementById('user-form').addEventListener('submit', function (e) {
      e.preventDefault();

      const usrEmail = document.getElementById('usrEmail').value;
      const usrPw = document.getElementById('usrPw').value;
      const usrPwCheck = document.getElementById('usrPwCheck').value;
      const usrNick = document.getElementById('usrNick').value;
      const stName_1 = document.getElementById('stName_1').value;
      const stName_2 = document.getElementById('stName_2').value;
      const stName_3 = document.getElementById('stName_3').value;

      if (pw !== pwCheck) {
        alert('비밀번호가 일치하지 않습니다.');
        return;
      }

      fetch('/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          usrEmail: email,
          usrPw: pw,
          usrNick: nick,
          stName_1: st1,
          stName_2: st2,
          stName_3: st3
        })
      }).then(res => res.text())
        .then(result => {
          if (result === 'success') {
            alert('회원정보가 성공적으로 수정되었습니다.');
            location.href = '/';
          } else {
            alert('실패: ' + result);
          }
        }).catch(err => {
          alert('서버 오류 발생: ' + err.message);
        });
    });
  </script>
</body>
</html>
